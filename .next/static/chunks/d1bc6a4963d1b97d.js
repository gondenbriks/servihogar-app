(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,32189,(e,t,s)=>{"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},65156,(e,t,s)=>{"use strict";var n=e.r(32189);function a(){}function i(){}i.resetWarningCache=a,t.exports=function(){function e(e,t,s,a,i,r){if(r!==n){var o=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function t(){return e}e.isRequired=e;var s={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:a};return s.PropTypes=s,s}},45009,(e,t,s)=>{t.exports=e.r(65156)()},76611,(e,t,s)=>{e.e,t.exports=function(){var e=[function(e,t){"use strict";function s(e,t,s,n){return({red:n[4*(s*t+e)],green:n[4*(s*t+e)+1],blue:n[4*(s*t+e)+2],alpha:n[4*(s*t+e)+3]}).alpha}function n(e,t,n,a){for(var i=e?1:-1,r=e?0:n-1,o=r;e?o<n:o>-1;o+=i)for(var l=0;l<t;l++)if(s(l,o,t,a))return o;return null}function a(e,t,n,a){for(var i=e?1:-1,r=e?0:t-1,o=r;e?o<t:o>-1;o+=i)for(var l=0;l<n;l++)if(s(o,l,t,a))return o;return null}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.getContext("2d"),s=e.width,i=e.height,r=t.getImageData(0,0,s,i).data,o=n(!0,s,i,r),l=n(!1,s,i,r),c=a(!0,s,i,r),d=a(!1,s,i,r)-c+1,u=l-o+1,h=t.getImageData(c,o,d,u);return e.width=d,e.height=u,t.clearRect(0,0,d,u),t.putImageData(h,0,0),e}}];function t(n){if(s[n])return s[n].exports;var a=s[n]={exports:{},id:n,loaded:!1};return e[n].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var s={};return t.m=e,t.c=s,t.p="",t(0)}()},89725,e=>{"use strict";e.i(47167);var t,s,n,a,i,r,o,l,c,d,u,h,p,f,m,x,g,b,y,v,w,_,N,j,C=e.i(43476),E=e.i(71645),k=e.i(18566),O=e.i(17927),S=e.i(73375),T=e.i(95116),I=e.i(75254);let R=(0,I.default)("Microscope",[["path",{d:"M6 18h8",key:"1borvv"}],["path",{d:"M3 22h18",key:"8prr45"}],["path",{d:"M14 22a7 7 0 1 0 0-14h-1",key:"1jwaiy"}],["path",{d:"M9 14h2",key:"197e7h"}],["path",{d:"M9 12a2 2 0 0 1-2-2V6h6v4a2 2 0 0 1-2 2Z",key:"1bmzmy"}],["path",{d:"M12 6V3a1 1 0 0 0-1-1H9a1 1 0 0 0-1 1v3",key:"1drr47"}]]);var A=e.i(87951),P=e.i(72664),M=e.i(74323),D=e.i(31245),L=e.i(43531),z=e.i(55436),U=e.i(63209),F=e.i(73884),q=e.i(52754),H=e.i(94983),B=e.i(43432);let $=(0,I.default)("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);var G=e.i(34858),W=e.i(84614);let Y=(0,I.default)("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]),K=(0,I.default)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),V=(0,I.default)("PenTool",[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]]),J=(0,I.default)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);var X=e.i(23962),Q=e.i(83086),Z=e.i(46932),ee=e.i(88653);(t=p||(p={})).STRING="string",t.NUMBER="number",t.INTEGER="integer",t.BOOLEAN="boolean",t.ARRAY="array",t.OBJECT="object",(s=f||(f={})).LANGUAGE_UNSPECIFIED="language_unspecified",s.PYTHON="python",(n=m||(m={})).OUTCOME_UNSPECIFIED="outcome_unspecified",n.OUTCOME_OK="outcome_ok",n.OUTCOME_FAILED="outcome_failed",n.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded";let et=["user","model","function","system"];(a=x||(x={})).HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",a.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",a.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",a.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",a.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",a.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",(i=g||(g={})).HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",i.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",i.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",i.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",i.BLOCK_NONE="BLOCK_NONE",(r=b||(b={})).HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",r.NEGLIGIBLE="NEGLIGIBLE",r.LOW="LOW",r.MEDIUM="MEDIUM",r.HIGH="HIGH",(o=y||(y={})).BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",o.SAFETY="SAFETY",o.OTHER="OTHER",(l=v||(v={})).FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",l.STOP="STOP",l.MAX_TOKENS="MAX_TOKENS",l.SAFETY="SAFETY",l.RECITATION="RECITATION",l.LANGUAGE="LANGUAGE",l.BLOCKLIST="BLOCKLIST",l.PROHIBITED_CONTENT="PROHIBITED_CONTENT",l.SPII="SPII",l.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",l.OTHER="OTHER",(c=w||(w={})).TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",c.RETRIEVAL_QUERY="RETRIEVAL_QUERY",c.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",c.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",c.CLASSIFICATION="CLASSIFICATION",c.CLUSTERING="CLUSTERING",(d=_||(_={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",d.AUTO="AUTO",d.ANY="ANY",d.NONE="NONE",(u=N||(N={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",u.MODE_DYNAMIC="MODE_DYNAMIC";class es extends Error{constructor(e){super(`[GoogleGenerativeAI Error]: ${e}`)}}class en extends es{constructor(e,t){super(e),this.response=t}}class ea extends es{constructor(e,t,s,n){super(e),this.status=t,this.statusText=s,this.errorDetails=n}}class ei extends es{}class er extends es{}(h=j||(j={})).GENERATE_CONTENT="generateContent",h.STREAM_GENERATE_CONTENT="streamGenerateContent",h.COUNT_TOKENS="countTokens",h.EMBED_CONTENT="embedContent",h.BATCH_EMBED_CONTENTS="batchEmbedContents";class eo{constructor(e,t,s,n,a){this.model=e,this.task=t,this.apiKey=s,this.stream=n,this.requestOptions=a}toString(){var e,t;let s=(null==(e=this.requestOptions)?void 0:e.apiVersion)||"v1beta",n=(null==(t=this.requestOptions)?void 0:t.baseUrl)||"https://generativelanguage.googleapis.com",a=`${n}/${s}/${this.model}:${this.task}`;return this.stream&&(a+="?alt=sse"),a}}async function el(e){var t,s;let n,a=new Headers;a.append("Content-Type","application/json"),a.append("x-goog-api-client",(s=e.requestOptions,n=[],(null==s?void 0:s.apiClient)&&n.push(s.apiClient),n.push("genai-js/0.24.1"),n.join(" "))),a.append("x-goog-api-key",e.apiKey);let i=null==(t=e.requestOptions)?void 0:t.customHeaders;if(i){if(!(i instanceof Headers))try{i=new Headers(i)}catch(e){throw new ei(`unable to convert customHeaders value ${JSON.stringify(i)} to Headers: ${e.message}`)}for(let[e,t]of i.entries()){if("x-goog-api-key"===e)throw new ei(`Cannot set reserved header name ${e}`);if("x-goog-api-client"===e)throw new ei(`Header name ${e} can only be set using the apiClient field`);a.append(e,t)}}return a}async function ec(e,t,s,n,a,i){let r=new eo(e,t,s,n,i);return{url:r.toString(),fetchOptions:Object.assign(Object.assign({},function(e){let t={};if((null==e?void 0:e.signal)!==void 0||(null==e?void 0:e.timeout)>=0){let s=new AbortController;(null==e?void 0:e.timeout)>=0&&setTimeout(()=>s.abort(),e.timeout),(null==e?void 0:e.signal)&&e.signal.addEventListener("abort",()=>{s.abort()}),t.signal=s.signal}return t}(i)),{method:"POST",headers:await el(r),body:a})}}async function ed(e,t,s,n,a,i={},r=fetch){let{url:o,fetchOptions:l}=await ec(e,t,s,n,a,i);return eu(o,l,r)}async function eu(e,t,s=fetch){let n;try{n=await s(e,t)}catch(s){var a=s,i=e;let t=a;throw"AbortError"===t.name?(t=new er(`Request aborted when fetching ${i.toString()}: ${a.message}`)).stack=a.stack:a instanceof ea||a instanceof ei||((t=new es(`Error fetching from ${i.toString()}: ${a.message}`)).stack=a.stack),t}return n.ok||await eh(n,e),n}async function eh(e,t){let s,n="";try{let t=await e.json();n=t.error.message,t.error.details&&(n+=` ${JSON.stringify(t.error.details)}`,s=t.error.details)}catch(e){}throw new ea(`Error fetching from ${t.toString()}: [${e.status} ${e.statusText}] ${n}`,e.status,e.statusText,s)}function ep(e){return e.text=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),ex(e.candidates[0]))throw new en(`${eg(e)}`,e);return function(e){var t,s,n,a;let i=[];if(null==(s=null==(t=e.candidates)?void 0:t[0].content)?void 0:s.parts)for(let t of null==(a=null==(n=e.candidates)?void 0:n[0].content)?void 0:a.parts)t.text&&i.push(t.text),t.executableCode&&i.push("\n```"+t.executableCode.language+"\n"+t.executableCode.code+"\n```\n"),t.codeExecutionResult&&i.push("\n```\n"+t.codeExecutionResult.output+"\n```\n");return i.length>0?i.join(""):""}(e)}if(e.promptFeedback)throw new en(`Text not available. ${eg(e)}`,e);return""},e.functionCall=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),ex(e.candidates[0]))throw new en(`${eg(e)}`,e);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),ef(e)[0]}if(e.promptFeedback)throw new en(`Function call not available. ${eg(e)}`,e)},e.functionCalls=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),ex(e.candidates[0]))throw new en(`${eg(e)}`,e);return ef(e)}if(e.promptFeedback)throw new en(`Function call not available. ${eg(e)}`,e)},e}function ef(e){var t,s,n,a;let i=[];if(null==(s=null==(t=e.candidates)?void 0:t[0].content)?void 0:s.parts)for(let t of null==(a=null==(n=e.candidates)?void 0:n[0].content)?void 0:a.parts)t.functionCall&&i.push(t.functionCall);return i.length>0?i:void 0}let em=[v.RECITATION,v.SAFETY,v.LANGUAGE];function ex(e){return!!e.finishReason&&em.includes(e.finishReason)}function eg(e){var t,s,n;let a="";if((!e.candidates||0===e.candidates.length)&&e.promptFeedback)a+="Response was blocked",(null==(t=e.promptFeedback)?void 0:t.blockReason)&&(a+=` due to ${e.promptFeedback.blockReason}`),(null==(s=e.promptFeedback)?void 0:s.blockReasonMessage)&&(a+=`: ${e.promptFeedback.blockReasonMessage}`);else if(null==(n=e.candidates)?void 0:n[0]){let t=e.candidates[0];ex(t)&&(a+=`Candidate was blocked due to ${t.finishReason}`,t.finishMessage&&(a+=`: ${t.finishMessage}`))}return a}function eb(e){return this instanceof eb?(this.v=e,this):new eb(e)}"function"==typeof SuppressedError&&SuppressedError;let ey=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;async function ev(e){let t=[],s=e.getReader();for(;;){let{done:e,value:n}=await s.read();if(e)return ep(function(e){let t=e[e.length-1],s={promptFeedback:null==t?void 0:t.promptFeedback};for(let t of e){if(t.candidates){let e=0;for(let n of t.candidates)if(s.candidates||(s.candidates=[]),s.candidates[e]||(s.candidates[e]={index:e}),s.candidates[e].citationMetadata=n.citationMetadata,s.candidates[e].groundingMetadata=n.groundingMetadata,s.candidates[e].finishReason=n.finishReason,s.candidates[e].finishMessage=n.finishMessage,s.candidates[e].safetyRatings=n.safetyRatings,n.content&&n.content.parts){s.candidates[e].content||(s.candidates[e].content={role:n.content.role||"user",parts:[]});let t={};for(let a of n.content.parts)a.text&&(t.text=a.text),a.functionCall&&(t.functionCall=a.functionCall),a.executableCode&&(t.executableCode=a.executableCode),a.codeExecutionResult&&(t.codeExecutionResult=a.codeExecutionResult),0===Object.keys(t).length&&(t.text=""),s.candidates[e].content.parts.push(t)}e++}t.usageMetadata&&(s.usageMetadata=t.usageMetadata)}return s}(t));t.push(n)}}async function ew(e,t,s,n){return function(e){let t,[s,n]=(t=e.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})).getReader(),new ReadableStream({start(e){let s="";return function n(){return t.read().then(({value:t,done:a})=>{let i;if(a)return s.trim()?void e.error(new es("Failed to parse stream")):void e.close();let r=(s+=t).match(ey);for(;r;){try{i=JSON.parse(r[1])}catch(t){e.error(new es(`Error parsing JSON response: "${r[1]}"`));return}e.enqueue(i),r=(s=s.substring(r[0].length)).match(ey)}return n()}).catch(e=>{let t=e;throw t.stack=e.stack,t="AbortError"===t.name?new er("Request aborted when reading from the stream"):new es("Error reading from the stream")})}()}})).tee();return{stream:function(e){return function(e,t,s){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var n,a=s.apply(e,t||[]),i=[];return n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n;function r(e){a[e]&&(n[e]=function(t){return new Promise(function(s,n){i.push([e,t,s,n])>1||o(e,t)})})}function o(e,t){try{var s;(s=a[e](t)).value instanceof eb?Promise.resolve(s.value.v).then(l,c):d(i[0][2],s)}catch(e){d(i[0][3],e)}}function l(e){o("next",e)}function c(e){o("throw",e)}function d(e,t){e(t),i.shift(),i.length&&o(i[0][0],i[0][1])}}(this,arguments,function*(){let t=e.getReader();for(;;){let{value:e,done:s}=yield eb(t.read());if(s)break;yield yield eb(ep(e))}})}(s),response:ev(n)}}(await ed(t,j.STREAM_GENERATE_CONTENT,e,!0,JSON.stringify(s),n))}async function e_(e,t,s,n){let a=await ed(t,j.GENERATE_CONTENT,e,!1,JSON.stringify(s),n);return{response:ep(await a.json())}}function eN(e){if(null!=e){if("string"==typeof e)return{role:"system",parts:[{text:e}]};if(e.text)return{role:"system",parts:[e]};if(e.parts)if(!e.role)return{role:"system",parts:e.parts};else return e}}function ej(e){let t=[];if("string"==typeof e)t=[{text:e}];else for(let s of e)"string"==typeof s?t.push({text:s}):t.push(s);var s=t;let n={role:"user",parts:[]},a={role:"function",parts:[]},i=!1,r=!1;for(let e of s)"functionResponse"in e?(a.parts.push(e),r=!0):(n.parts.push(e),i=!0);if(i&&r)throw new es("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!i&&!r)throw new es("No content is provided for sending chat message.");return i?n:a}function eC(e){let t;return t=e.contents?e:{contents:[ej(e)]},e.systemInstruction&&(t.systemInstruction=eN(e.systemInstruction)),t}let eE=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],ek={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]};function eO(e){var t;if(void 0===e.candidates||0===e.candidates.length)return!1;let s=null==(t=e.candidates[0])?void 0:t.content;if(void 0===s||void 0===s.parts||0===s.parts.length)return!1;for(let e of s.parts)if(void 0===e||0===Object.keys(e).length||void 0!==e.text&&""===e.text)return!1;return!0}let eS="SILENT_ERROR";class eT{constructor(e,t,s,n={}){this.model=t,this.params=s,this._requestOptions=n,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=e,(null==s?void 0:s.history)&&(!function(e){let t=!1;for(let s of e){let{role:e,parts:n}=s;if(!t&&"user"!==e)throw new es(`First content should be with role 'user', got ${e}`);if(!et.includes(e))throw new es(`Each item should include role field. Got ${e} but valid roles are: ${JSON.stringify(et)}`);if(!Array.isArray(n))throw new es("Content should have 'parts' property with an array of Parts");if(0===n.length)throw new es("Each Content should have at least one part");let a={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(let e of n)for(let t of eE)t in e&&(a[t]+=1);let i=ek[e];for(let t of eE)if(!i.includes(t)&&a[t]>0)throw new es(`Content with role '${e}' can't contain '${t}' part`);t=!0}}(s.history),this._history=s.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(e,t={}){var s,n,a,i,r,o;let l;await this._sendPromise;let c=ej(e),d={safetySettings:null==(s=this.params)?void 0:s.safetySettings,generationConfig:null==(n=this.params)?void 0:n.generationConfig,tools:null==(a=this.params)?void 0:a.tools,toolConfig:null==(i=this.params)?void 0:i.toolConfig,systemInstruction:null==(r=this.params)?void 0:r.systemInstruction,cachedContent:null==(o=this.params)?void 0:o.cachedContent,contents:[...this._history,c]},u=Object.assign(Object.assign({},this._requestOptions),t);return this._sendPromise=this._sendPromise.then(()=>e_(this._apiKey,this.model,d,u)).then(e=>{var t;if(eO(e.response)){this._history.push(c);let s=Object.assign({parts:[],role:"model"},null==(t=e.response.candidates)?void 0:t[0].content);this._history.push(s)}else{let t=eg(e.response);t&&console.warn(`sendMessage() was unsuccessful. ${t}. Inspect response object for details.`)}l=e}).catch(e=>{throw this._sendPromise=Promise.resolve(),e}),await this._sendPromise,l}async sendMessageStream(e,t={}){var s,n,a,i,r,o;await this._sendPromise;let l=ej(e),c={safetySettings:null==(s=this.params)?void 0:s.safetySettings,generationConfig:null==(n=this.params)?void 0:n.generationConfig,tools:null==(a=this.params)?void 0:a.tools,toolConfig:null==(i=this.params)?void 0:i.toolConfig,systemInstruction:null==(r=this.params)?void 0:r.systemInstruction,cachedContent:null==(o=this.params)?void 0:o.cachedContent,contents:[...this._history,l]},d=Object.assign(Object.assign({},this._requestOptions),t),u=ew(this._apiKey,this.model,c,d);return this._sendPromise=this._sendPromise.then(()=>u).catch(e=>{throw Error(eS)}).then(e=>e.response).then(e=>{if(eO(e)){this._history.push(l);let t=Object.assign({},e.candidates[0].content);t.role||(t.role="model"),this._history.push(t)}else{let t=eg(e);t&&console.warn(`sendMessageStream() was unsuccessful. ${t}. Inspect response object for details.`)}}).catch(e=>{e.message!==eS&&console.error(e)}),u}}async function eI(e,t,s,n){return(await ed(t,j.COUNT_TOKENS,e,!1,JSON.stringify(s),n)).json()}async function eR(e,t,s,n){return(await ed(t,j.EMBED_CONTENT,e,!1,JSON.stringify(s),n)).json()}async function eA(e,t,s,n){let a=s.requests.map(e=>Object.assign(Object.assign({},e),{model:t}));return(await ed(t,j.BATCH_EMBED_CONTENTS,e,!1,JSON.stringify({requests:a}),n)).json()}class eP{constructor(e,t,s={}){this.apiKey=e,this._requestOptions=s,t.model.includes("/")?this.model=t.model:this.model=`models/${t.model}`,this.generationConfig=t.generationConfig||{},this.safetySettings=t.safetySettings||[],this.tools=t.tools,this.toolConfig=t.toolConfig,this.systemInstruction=eN(t.systemInstruction),this.cachedContent=t.cachedContent}async generateContent(e,t={}){var s;let n=eC(e),a=Object.assign(Object.assign({},this._requestOptions),t);return e_(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:null==(s=this.cachedContent)?void 0:s.name},n),a)}async generateContentStream(e,t={}){var s;let n=eC(e),a=Object.assign(Object.assign({},this._requestOptions),t);return ew(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:null==(s=this.cachedContent)?void 0:s.name},n),a)}startChat(e){var t;return new eT(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:null==(t=this.cachedContent)?void 0:t.name},e),this._requestOptions)}async countTokens(e,t={}){let s=function(e,t){var s;let n={model:null==t?void 0:t.model,generationConfig:null==t?void 0:t.generationConfig,safetySettings:null==t?void 0:t.safetySettings,tools:null==t?void 0:t.tools,toolConfig:null==t?void 0:t.toolConfig,systemInstruction:null==t?void 0:t.systemInstruction,cachedContent:null==(s=null==t?void 0:t.cachedContent)?void 0:s.name,contents:[]},a=null!=e.generateContentRequest;if(e.contents){if(a)throw new ei("CountTokensRequest must have one of contents or generateContentRequest, not both.");n.contents=e.contents}else if(a)n=Object.assign(Object.assign({},n),e.generateContentRequest);else{let t=ej(e);n.contents=[t]}return{generateContentRequest:n}}(e,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),n=Object.assign(Object.assign({},this._requestOptions),t);return eI(this.apiKey,this.model,s,n)}async embedContent(e,t={}){let s="string"==typeof e||Array.isArray(e)?{content:ej(e)}:e,n=Object.assign(Object.assign({},this._requestOptions),t);return eR(this.apiKey,this.model,s,n)}async batchEmbedContents(e,t={}){let s=Object.assign(Object.assign({},this._requestOptions),t);return eA(this.apiKey,this.model,e,s)}}function eM(){return(eM=Object.assign.bind()).apply(null,arguments)}function eD(e){return(eD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eL(e,t){return(eL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function ez(e){return(ez=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function eU(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(eU=function(){return!!e})()}var eF=e.i(45009);function eq(e,t,s){this.x=e,this.y=t,this.time=s||new Date().getTime()}function eH(e,t,s,n){this.startPoint=e,this.control1=t,this.control2=s,this.endPoint=n}function eB(e,t){var s,n,a,i,r,o,l,c,d,u=this,h=t||{};(this.velocityFilterWeight=h.velocityFilterWeight||.7,this.minWidth=h.minWidth||.5,this.maxWidth=h.maxWidth||2.5,this.throttle="throttle"in h?h.throttle:16,this.minDistance="minDistance"in h?h.minDistance:5,this.throttle)?this._strokeMoveUpdate=(s=eB.prototype._strokeUpdate,n=this.throttle,l=null,c=0,a||(a={}),d=function(){c=!1===a.leading?0:Date.now(),l=null,o=s.apply(i,r),l||(i=r=null)},function(){var e=Date.now();c||!1!==a.leading||(c=e);var t=n-(e-c);return i=this,r=arguments,t<=0||t>n?(l&&(clearTimeout(l),l=null),c=e,o=s.apply(i,r),l||(i=r=null)):l||!1===a.trailing||(l=setTimeout(d,t)),o}):this._strokeMoveUpdate=eB.prototype._strokeUpdate,this.dotSize=h.dotSize||function(){return(this.minWidth+this.maxWidth)/2},this.penColor=h.penColor||"black",this.backgroundColor=h.backgroundColor||"rgba(0,0,0,0)",this.onBegin=h.onBegin,this.onEnd=h.onEnd,this._canvas=e,this._ctx=e.getContext("2d"),this.clear(),this._handleMouseDown=function(e){1===e.which&&(u._mouseButtonDown=!0,u._strokeBegin(e))},this._handleMouseMove=function(e){u._mouseButtonDown&&u._strokeMoveUpdate(e)},this._handleMouseUp=function(e){1===e.which&&u._mouseButtonDown&&(u._mouseButtonDown=!1,u._strokeEnd(e))},this._handleTouchStart=function(e){if(1===e.targetTouches.length){var t=e.changedTouches[0];u._strokeBegin(t)}},this._handleTouchMove=function(e){e.preventDefault();var t=e.targetTouches[0];u._strokeMoveUpdate(t)},this._handleTouchEnd=function(e){e.target===u._canvas&&(e.preventDefault(),u._strokeEnd(e))},this.on()}eq.prototype.velocityFrom=function(e){return this.time!==e.time?this.distanceTo(e)/(this.time-e.time):1},eq.prototype.distanceTo=function(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))},eq.prototype.equals=function(e){return this.x===e.x&&this.y===e.y&&this.time===e.time},eH.prototype.length=function(){for(var e=0,t=void 0,s=void 0,n=0;n<=10;n+=1){var a=n/10,i=this._point(a,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),r=this._point(a,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);if(n>0){var o=i-t,l=r-s;e+=Math.sqrt(o*o+l*l)}t=i,s=r}return e},eH.prototype._point=function(e,t,s,n,a){return t*(1-e)*(1-e)*(1-e)+3*s*(1-e)*(1-e)*e+3*n*(1-e)*e*e+a*e*e*e},eB.prototype.clear=function(){var e=this._ctx,t=this._canvas;e.fillStyle=this.backgroundColor,e.clearRect(0,0,t.width,t.height),e.fillRect(0,0,t.width,t.height),this._data=[],this._reset(),this._isEmpty=!0},eB.prototype.fromDataURL=function(e){var t=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new Image,a=s.ratio||window.devicePixelRatio||1,i=s.width||this._canvas.width/a,r=s.height||this._canvas.height/a;this._reset(),n.src=e,n.onload=function(){t._ctx.drawImage(n,0,0,i,r)},this._isEmpty=!1},eB.prototype.toDataURL=function(e){var t;if("image/svg+xml"===e)return this._toSVG();for(var s=arguments.length,n=Array(s>1?s-1:0),a=1;a<s;a++)n[a-1]=arguments[a];return(t=this._canvas).toDataURL.apply(t,[e].concat(n))},eB.prototype.on=function(){this._handleMouseEvents(),this._handleTouchEvents()},eB.prototype.off=function(){this._canvas.removeEventListener("mousedown",this._handleMouseDown),this._canvas.removeEventListener("mousemove",this._handleMouseMove),document.removeEventListener("mouseup",this._handleMouseUp),this._canvas.removeEventListener("touchstart",this._handleTouchStart),this._canvas.removeEventListener("touchmove",this._handleTouchMove),this._canvas.removeEventListener("touchend",this._handleTouchEnd)},eB.prototype.isEmpty=function(){return this._isEmpty},eB.prototype._strokeBegin=function(e){this._data.push([]),this._reset(),this._strokeUpdate(e),"function"==typeof this.onBegin&&this.onBegin(e)},eB.prototype._strokeUpdate=function(e){var t=e.clientX,s=e.clientY,n=this._createPoint(t,s),a=this._data[this._data.length-1],i=a&&a[a.length-1],r=i&&n.distanceTo(i)<this.minDistance;if(!(i&&r)){var o=this._addPoint(n),l=o.curve,c=o.widths;l&&c&&this._drawCurve(l,c.start,c.end),this._data[this._data.length-1].push({x:n.x,y:n.y,time:n.time,color:this.penColor})}},eB.prototype._strokeEnd=function(e){var t=this.points.length>2,s=this.points[0];if(!t&&s&&this._drawDot(s),s){var n=this._data[this._data.length-1],a=n[n.length-1];s.equals(a)||n.push({x:s.x,y:s.y,time:s.time,color:this.penColor})}"function"==typeof this.onEnd&&this.onEnd(e)},eB.prototype._handleMouseEvents=function(){this._mouseButtonDown=!1,this._canvas.addEventListener("mousedown",this._handleMouseDown),this._canvas.addEventListener("mousemove",this._handleMouseMove),document.addEventListener("mouseup",this._handleMouseUp)},eB.prototype._handleTouchEvents=function(){this._canvas.style.msTouchAction="none",this._canvas.style.touchAction="none",this._canvas.addEventListener("touchstart",this._handleTouchStart),this._canvas.addEventListener("touchmove",this._handleTouchMove),this._canvas.addEventListener("touchend",this._handleTouchEnd)},eB.prototype._reset=function(){this.points=[],this._lastVelocity=0,this._lastWidth=(this.minWidth+this.maxWidth)/2,this._ctx.fillStyle=this.penColor},eB.prototype._createPoint=function(e,t,s){var n=this._canvas.getBoundingClientRect();return new eq(e-n.left,t-n.top,s||new Date().getTime())},eB.prototype._addPoint=function(e){var t=this.points;if(t.push(e),t.length>2){3===t.length&&t.unshift(t[0]);var s=this._calculateCurveControlPoints(t[0],t[1],t[2]).c2,n=this._calculateCurveControlPoints(t[1],t[2],t[3]).c1,a=new eH(t[1],s,n,t[2]),i=this._calculateCurveWidths(a);return t.shift(),{curve:a,widths:i}}return{}},eB.prototype._calculateCurveControlPoints=function(e,t,s){var n=e.x-t.x,a=e.y-t.y,i=t.x-s.x,r=t.y-s.y,o={x:(e.x+t.x)/2,y:(e.y+t.y)/2},l={x:(t.x+s.x)/2,y:(t.y+s.y)/2},c=Math.sqrt(n*n+a*a),d=Math.sqrt(i*i+r*r),u=o.x-l.x,h=o.y-l.y,p=d/(c+d),f={x:l.x+u*p,y:l.y+h*p},m=t.x-f.x,x=t.y-f.y;return{c1:new eq(o.x+m,o.y+x),c2:new eq(l.x+m,l.y+x)}},eB.prototype._calculateCurveWidths=function(e){var t=e.startPoint,s=e.endPoint,n={start:null,end:null},a=this.velocityFilterWeight*s.velocityFrom(t)+(1-this.velocityFilterWeight)*this._lastVelocity,i=this._strokeWidth(a);return n.start=this._lastWidth,n.end=i,this._lastVelocity=a,this._lastWidth=i,n},eB.prototype._strokeWidth=function(e){return Math.max(this.maxWidth/(e+1),this.minWidth)},eB.prototype._drawPoint=function(e,t,s){var n=this._ctx;n.moveTo(e,t),n.arc(e,t,s,0,2*Math.PI,!1),this._isEmpty=!1},eB.prototype._drawCurve=function(e,t,s){var n=this._ctx,a=s-t,i=Math.floor(e.length());n.beginPath();for(var r=0;r<i;r+=1){var o=r/i,l=o*o,c=l*o,d=1-o,u=d*d,h=u*d,p=h*e.startPoint.x;p+=3*u*o*e.control1.x+3*d*l*e.control2.x+c*e.endPoint.x;var f=h*e.startPoint.y;f+=3*u*o*e.control1.y+3*d*l*e.control2.y+c*e.endPoint.y;var m=t+c*a;this._drawPoint(p,f,m)}n.closePath(),n.fill()},eB.prototype._drawDot=function(e){var t=this._ctx,s="function"==typeof this.dotSize?this.dotSize():this.dotSize;t.beginPath(),this._drawPoint(e.x,e.y,s),t.closePath(),t.fill()},eB.prototype._fromData=function(e,t,s){for(var n=0;n<e.length;n+=1){var a=e[n];if(a.length>1)for(var i=0;i<a.length;i+=1){var r=a[i],o=new eq(r.x,r.y,r.time),l=r.color;if(0===i)this.penColor=l,this._reset(),this._addPoint(o);else if(i!==a.length-1){var c=this._addPoint(o),d=c.curve,u=c.widths;d&&u&&t(d,u,l)}}else this._reset(),s(a[0])}},eB.prototype._toSVG=function(){var e=this,t=this._data,s=this._canvas,n=Math.max(window.devicePixelRatio||1,1),a=s.width/n,i=s.height/n,r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.setAttributeNS(null,"width",s.width),r.setAttributeNS(null,"height",s.height),this._fromData(t,function(e,t,s){var n=document.createElement("path");if(!isNaN(e.control1.x)&&!isNaN(e.control1.y)&&!isNaN(e.control2.x)&&!isNaN(e.control2.y)){var a="M "+e.startPoint.x.toFixed(3)+","+e.startPoint.y.toFixed(3)+" "+("C "+e.control1.x.toFixed(3)+",")+e.control1.y.toFixed(3)+" "+(e.control2.x.toFixed(3)+",")+e.control2.y.toFixed(3)+" "+e.endPoint.x.toFixed(3)+","+e.endPoint.y.toFixed(3);n.setAttribute("d",a),n.setAttribute("stroke-width",(2.25*t.end).toFixed(3)),n.setAttribute("stroke",s),n.setAttribute("fill","none"),n.setAttribute("stroke-linecap","round"),r.appendChild(n)}},function(t){var s=document.createElement("circle"),n="function"==typeof e.dotSize?e.dotSize():e.dotSize;s.setAttribute("r",n),s.setAttribute("cx",t.x),s.setAttribute("cy",t.y),s.setAttribute("fill",t.color),r.appendChild(s)});var o='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"'+(' viewBox="0 0 '+a+" ")+i+'" width="'+a+'" height="'+i+'">',l=r.innerHTML;if(void 0===l){var c=document.createElement("dummy"),d=r.childNodes;c.innerHTML="";for(var u=0;u<d.length;u+=1)c.appendChild(d[u].cloneNode(!0));l=c.innerHTML}return"data:image/svg+xml;base64,"+btoa(o+l+"</svg>")},eB.prototype.fromData=function(e){var t=this;this.clear(),this._fromData(e,function(e,s){return t._drawCurve(e,s.start,s.end)},function(e){return t._drawDot(e)}),this._data=e},eB.prototype.toData=function(){return this._data};var e$=e.i(76611),eG=["canvasProps","clearOnResize"],eW=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&eL(n,e);var t,s=(t=eU(),function(){var e,s=ez(n);e=t?Reflect.construct(s,arguments,ez(this).constructor):s.apply(this,arguments);if(e&&("object"==eD(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");if(void 0===this)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return this});function n(){var e;if(!(this instanceof n))throw TypeError("Cannot call a class as a function");for(var t=arguments.length,a=Array(t),i=0;i<t;i++)a[i]=arguments[i];return(e=s.call.apply(s,[this].concat(a))).staticThis=e.constructor,e._sigPad=null,e._canvas=null,e.setRef=function(t){e._canvas=t,null===e._canvas&&(e._sigPad=null)},e._excludeOurProps=function(){var t=e.props;return t.canvasProps,t.clearOnResize,function(e,t){if(null==e)return{};var s,n,a=function(e,t){if(null==e)return{};var s={};for(var n in e)if(({}).hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;s[n]=e[n]}return s}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)s=i[n],-1===t.indexOf(s)&&({}).propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}(t,eG)},e.componentDidMount=function(){var t=e.getCanvas();e._sigPad=new eB(t,e._excludeOurProps()),e._resizeCanvas(),e.on()},e.componentWillUnmount=function(){e.off()},e.componentDidUpdate=function(){Object.assign(e._sigPad,e._excludeOurProps())},e.getCanvas=function(){if(null===e._canvas)throw e.staticThis.refNullError;return e._canvas},e.getTrimmedCanvas=function(){var t=e.getCanvas(),s=document.createElement("canvas");return s.width=t.width,s.height=t.height,s.getContext("2d").drawImage(t,0,0),(0,e$.default)(s)},e.getSignaturePad=function(){if(null===e._sigPad)throw e.staticThis.refNullError;return e._sigPad},e._checkClearOnResize=function(){e.props.clearOnResize&&e._resizeCanvas()},e._resizeCanvas=function(){var t,s,n=null!=(t=e.props.canvasProps)?t:{},a=n.width,i=n.height;if(void 0===a||void 0===i){var r=e.getCanvas(),o=Math.max(null!=(s=window.devicePixelRatio)?s:1,1);void 0===a&&(r.width=r.offsetWidth*o),void 0===i&&(r.height=r.offsetHeight*o),r.getContext("2d").scale(o,o),e.clear()}},e.render=function(){var t=e.props.canvasProps;return E.default.createElement("canvas",eM({ref:e.setRef},t))},e.on=function(){return window.addEventListener("resize",e._checkClearOnResize),e.getSignaturePad().on()},e.off=function(){return window.removeEventListener("resize",e._checkClearOnResize),e.getSignaturePad().off()},e.clear=function(){return e.getSignaturePad().clear()},e.isEmpty=function(){return e.getSignaturePad().isEmpty()},e.fromDataURL=function(t,s){return e.getSignaturePad().fromDataURL(t,s)},e.toDataURL=function(t,s){return e.getSignaturePad().toDataURL(t,s)},e.fromData=function(t){return e.getSignaturePad().fromData(t)},e.toData=function(){return e.getSignaturePad().toData()},e}return Object.defineProperty(n,"prototype",{writable:!1}),n}(E.Component);eW.propTypes={velocityFilterWeight:eF.default.number,minWidth:eF.default.number,maxWidth:eF.default.number,minDistance:eF.default.number,dotSize:eF.default.oneOfType([eF.default.number,eF.default.func]),penColor:eF.default.string,throttle:eF.default.number,onEnd:eF.default.func,onBegin:eF.default.func,canvasProps:eF.default.object,clearOnResize:eF.default.bool},eW.defaultProps={clearOnResize:!0},eW.refNullError=Error("react-signature-canvas is currently mounting or unmounting: React refs are null during this phase.");var eY=e.i(27612),eK=e.i(95468);function eV({onSave:e,onClear:t}){let s=(0,E.useRef)(null);return(0,C.jsxs)("div",{className:"w-full space-y-4",children:[(0,C.jsxs)("div",{className:"relative w-full h-48 bg-white rounded-3xl overflow-hidden border-4 border-gray-900 shadow-2xl flex items-center justify-center cursor-crosshair",children:[(0,C.jsx)(eW,{ref:s,penColor:"black",canvasProps:{className:"w-full h-full signature-canvas"}}),(0,C.jsx)("div",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 pointer-events-none",children:(0,C.jsx)("span",{className:"text-gray-300 font-bold text-[10px] uppercase select-none opacity-50 tracking-widest",children:"Firme dentro del recuadro"})})]}),(0,C.jsxs)("div",{className:"flex gap-3",children:[(0,C.jsxs)("button",{onClick:()=>{s.current?.clear(),t&&t()},className:"flex-1 bg-gray-900/50 border border-white/5 text-gray-400 font-bold py-3 px-4 rounded-2xl flex items-center justify-center gap-2 hover:bg-rose-500/10 hover:text-rose-500 transition-all",children:[(0,C.jsx)(eY.Trash2,{size:16}),(0,C.jsx)("span",{className:"text-[10px] uppercase tracking-widest",children:"Borrar"})]}),(0,C.jsxs)("button",{onClick:()=>{if(s.current?.isEmpty())return void alert("Por favor, firme antes de guardar.");let t=s.current?.getTrimmedCanvas().toDataURL("image/png");t&&e(t)},className:"flex-1 bg-[#00ff9d]/10 border border-[#00ff9d]/20 text-[#00ff9d] font-bold py-3 px-4 rounded-2xl flex items-center justify-center gap-2 hover:bg-[#00ff9d] hover:text-black transition-all",children:[(0,C.jsx)(eK.CheckCircle2,{size:16}),(0,C.jsx)("span",{className:"text-[10px] uppercase tracking-widest",children:"Confirmar Firma"})]})]})]})}let eJ=new class{constructor(e){this.apiKey=e}getGenerativeModel(e,t){if(!e.model)throw new es("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new eP(this.apiKey,e,t)}getGenerativeModelFromCachedContent(e,t,s){if(!e.name)throw new ei("Cached content must contain a `name` field.");if(!e.model)throw new ei("Cached content must contain a `model` field.");for(let s of["model","systemInstruction"])if((null==t?void 0:t[s])&&e[s]&&(null==t?void 0:t[s])!==e[s]){if("model"===s&&(t.model.startsWith("models/")?t.model.replace("models/",""):t.model)===(e.model.startsWith("models/")?e.model.replace("models/",""):e.model))continue;throw new ei(`Different value for "${s}" specified in modelParams (${t[s]}) and cachedContent (${e[s]})`)}let n=Object.assign(Object.assign({},t),{model:e.model,tools:e.tools,toolConfig:e.toolConfig,systemInstruction:e.systemInstruction,cachedContent:e});return new eP(this.apiKey,n,s)}}("AIzaSyCXan_p6VbUAykQyiPsWhsuJHsExgSnSWM").getGenerativeModel({model:"gemini-1.5-flash"});function eX(){let e=(0,k.useRouter)(),t=(0,k.useParams)().id,[s,n]=(0,E.useState)(null),[a,i]=(0,E.useState)(""),[r,o]=(0,E.useState)(""),[l,c]=(0,E.useState)(null),[d,u]=(0,E.useState)(!1),[h,p]=(0,E.useState)(""),[f,m]=(0,E.useState)(!1),[x,g]=(0,E.useState)(!0),[b,y]=(0,E.useState)(!1),[v,w]=(0,E.useState)(!1),[_,N]=(0,E.useState)("0"),[j,I]=(0,E.useState)([]),[et,es]=(0,E.useState)([]),[en,ea]=(0,E.useState)(!1),[ei,er]=(0,E.useState)("");(0,E.useEffect)(()=>{t&&eo()},[t]),(0,E.useEffect)(()=>{let e=localStorage.getItem("scanned_part_data");if(e)try{let s=JSON.parse(e);s.serviceId===t&&eh(s),localStorage.removeItem("scanned_part_data")}catch(e){console.error("Error parsing scanned part:",e)}},[t,s]);let eo=async()=>{g(!0);try{let{data:e,error:s}=await O.supabase.from("service_orders").select(`
                    *,
                    client:clients(*),
                    equipment:equipment(*),
                    order_items(
                        id,
                        quantity,
                        price_at_time,
                        part:parts(id, name, code)
                    )
                `).eq("id",t).single();if(s)throw s;e&&(n(e),i(e.technical_diagnosis||""),N(e.labor_cost?.toString()||"0"),e.order_items&&I(e.order_items.map(e=>({...e.part,quantity:e.quantity,unit_price:e.price_at_time}))));let{data:a}=await O.supabase.from("parts").select("*").gt("stock_level",0);es(a||[])}catch(e){console.error("Error loading order:",e)}finally{g(!1)}},el=async()=>{if(t){y(!0);try{let{error:e}=await O.supabase.from("service_orders").update({status:"IN_PROGRESS"}).eq("id",t);if(e)throw e;n({...s,status:"IN_PROGRESS"})}catch(e){console.error("Error activating service:",e)}finally{y(!1)}}},ec=async()=>{if(s){u(!0),m(!0);try{let e=`Redacta un mensaje profesional de WhatsApp para el cliente "${s.client?.full_name}" confirmando su servicio t\xe9cnico de hoy.
            - Equipo: ${s.equipment?.brand} ${s.equipment?.type}
            - Problema: ${s.reported_issue}
            - Hora programada: ${new Date(s.scheduled_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}
            Instrucciones: Corto (m\xe1ximo 40 palabras), usa emojis (üîß, üìç, ‚úÖ), menciona que el t\xe9cnico ya tiene asignada la ruta. Sin etiquetas extra.`,t=await eJ.generateContent(e),n=await t.response;p(n.text())}catch(e){p(`Hola ${s.client?.full_name}, le confirmamos su visita t\xe9cnica para hoy. El t\xe9cnico se encuentra en ruta. \xa1Nos vemos pronto! üîß`)}finally{m(!1)}}},ed=async()=>{if(!s)return;w(!0);let e=s.equipment?.type+" "+s.equipment?.brand,t=s.reported_issue,n=`Act\xfaa como un t\xe9cnico experto. Escribe una lista corta (m\xe1ximo 3 puntos) de recomendaciones de cuidado para el cliente sobre su ${e}, considerando que la falla fue: ${t}. 
    Usa un tono profesional pero amable. Formato: Vi\xf1etas con emojis.`;try{let e=await eJ.generateContent(n),t=await e.response;o(t.text())}catch(e){console.error("Error generating recommendations:",e)}finally{w(!1)}},eu=async()=>{if(t){y(!0);try{let s=j.reduce((e,t)=>e+t.unit_price*t.quantity,0),n=Number(_)+s,{error:i}=await O.supabase.from("service_orders").update({technical_diagnosis:a,labor_cost:Number(_),status:"COMPLETED",completed_at:new Date().toISOString(),total_cost:n}).eq("id",t);if(i)throw i;if(j.length>0){let e=j.map(e=>({order_id:t,part_id:e.id,quantity:e.quantity,price_at_time:e.unit_price})),{error:s}=await O.supabase.from("order_items").insert(e);if(s)throw s;for(let e of j){let{data:t}=await O.supabase.from("parts").select("stock_level").eq("id",e.id).single();t&&await O.supabase.from("parts").update({stock_level:t.stock_level-e.quantity}).eq("id",e.id)}}e.push(`/invoice-preview/${t}`)}catch(e){alert("Error al finalizar la orden: "+e.message)}finally{y(!1)}}},eh=e=>{j.find(t=>t.id===e.id)?I(j.map(t=>t.id===e.id?{...t,quantity:t.quantity+1}:t)):I([...j,{...e,quantity:1}]),ea(!1)};return x?(0,C.jsxs)("div",{className:"bg-[#0a0c10] min-h-screen flex flex-col items-center justify-center text-white",children:[(0,C.jsx)("div",{className:"w-12 h-12 border-4 border-[#135bec]/30 border-t-[#135bec] rounded-full animate-spin mb-4"}),(0,C.jsx)("p",{className:"text-sm font-bold opacity-50",children:"Cargando detalles del servicio..."})]}):(0,C.jsxs)("div",{className:"relative flex h-full min-h-screen w-full flex-col max-w-md mx-auto shadow-2xl overflow-hidden bg-[#0a0c10] font-sans text-white border-x border-white/5",children:[(0,C.jsxs)("header",{className:"sticky top-0 z-[60] flex items-center justify-between bg-[#0a0c10]/95 backdrop-blur-md p-4 border-b border-white/5",children:[(0,C.jsx)("button",{onClick:()=>e.back(),className:"flex size-10 items-center justify-center rounded-2xl bg-white/5 hover:bg-white/10 transition-colors",children:(0,C.jsx)(S.ChevronLeft,{className:"text-gray-300",size:24})}),(0,C.jsxs)("div",{className:"flex flex-col items-center",children:[(0,C.jsx)("h2",{className:"text-[10px] font-black uppercase tracking-[0.3em] text-[#135bec]",children:"Orden de Servicio"}),(0,C.jsx)("p",{className:"text-[10px] font-mono font-bold text-gray-500 uppercase tracking-widest",children:s?.order_number||"ORD-SYNC"})]}),(0,C.jsx)("button",{onClick:()=>e.push("/agenda"),className:"flex h-10 px-3 items-center justify-center rounded-2xl bg-rose-500/5 hover:bg-rose-500/10 transition-colors text-rose-500 text-[10px] font-black uppercase tracking-widest border border-rose-500/10",children:"Cancelar"})]}),(0,C.jsx)(ee.AnimatePresence,{mode:"wait",children:s?.status==="PENDING"?(0,C.jsxs)(Z.motion.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"flex-1 overflow-y-auto",children:[(0,C.jsxs)("div",{className:"relative h-48 w-full group overflow-hidden",children:[(0,C.jsx)("div",{className:"absolute inset-0 bg-[url('https://www.google.com/maps/d/u/0/thumbnail?mid=1S95_X_M0Hk4q9C7E5N_W5J9t-s0&msa=0')] bg-cover bg-center grayscale opacity-40 group-hover:opacity-60 transition-opacity"}),(0,C.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-[#0a0c10] to-transparent"}),(0,C.jsxs)(Z.motion.button,{whileTap:{scale:.95},className:"absolute bottom-6 right-6 bg-[#135bec] hover:bg-blue-600 text-white px-6 py-3.5 rounded-[1.5rem] text-[10px] font-black uppercase tracking-widest flex items-center gap-3 shadow-2xl shadow-[#135bec]/40 transition-all",children:[(0,C.jsx)(G.Navigation,{size:16}),"Abrir Navegador GPS"]})]}),(0,C.jsxs)("main",{className:"px-6 -mt-6 relative z-10 space-y-6 pb-20",children:[(0,C.jsx)("div",{className:"bg-gray-900/40 border border-white/5 backdrop-blur-xl rounded-[2.5rem] p-5 flex items-center justify-between shadow-xl",children:(0,C.jsxs)("div",{className:"flex items-center gap-4",children:[(0,C.jsx)("div",{className:"size-12 rounded-2xl bg-[#135bec]/10 flex items-center justify-center text-[#135bec]",children:(0,C.jsx)(Y,{size:24})}),(0,C.jsxs)("div",{children:[(0,C.jsx)("p",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest",children:"Estado Actual"}),(0,C.jsxs)("div",{className:"flex items-center gap-2 mt-0.5",children:[(0,C.jsx)("div",{className:"size-2 rounded-full bg-amber-500 animate-pulse"}),(0,C.jsx)("p",{className:"text-sm font-black text-white",children:"Pendiente de Activaci√≥n"})]})]})]})}),(0,C.jsxs)("div",{className:"bg-gray-900/20 border border-white/5 rounded-[3rem] p-8 space-y-8 animate-fade-in shadow-inner",children:[(0,C.jsxs)("div",{className:"flex justify-between items-start",children:[(0,C.jsxs)("div",{className:"space-y-2",children:[(0,C.jsx)("span",{className:"px-3 py-1 rounded-full bg-[#135bec]/10 text-[#135bec] text-[9px] font-black uppercase tracking-widest border border-[#135bec]/20",children:"Propietario"}),(0,C.jsx)("h1",{className:"text-2xl font-black text-white tracking-tight leading-tight",children:s.client?.full_name}),(0,C.jsxs)("div",{className:"flex items-center gap-2 text-gray-500 text-xs",children:[(0,C.jsx)($,{size:14,className:"text-rose-500"}),(0,C.jsx)("p",{className:"font-bold",children:s.client?.address})]})]}),(0,C.jsxs)("div",{className:"bg-gray-900/80 border border-white/10 rounded-3xl p-4 text-center min-w-[90px] shadow-2xl",children:[(0,C.jsx)("p",{className:"text-[9px] font-black text-[#135bec] uppercase tracking-[0.2em] mb-1",children:"Cita"}),(0,C.jsx)("p",{className:"text-xl font-black text-white font-mono",children:new Date(s.scheduled_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]}),(0,C.jsxs)("div",{className:"space-y-4 pt-4",children:[(0,C.jsxs)("div",{className:"bg-white/5 rounded-3xl p-5 border border-white/5 flex gap-4",children:[(0,C.jsx)("div",{className:"size-10 rounded-2xl bg-orange-500/10 flex items-center justify-center text-orange-400 shrink-0",children:(0,C.jsx)(U.AlertCircle,{size:20})}),(0,C.jsxs)("div",{children:[(0,C.jsx)("p",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest mb-1",children:"Motivo de Visita"}),(0,C.jsxs)("p",{className:"text-sm font-bold text-gray-300 leading-relaxed italic",children:['"',s.reported_issue,'"']})]})]}),(0,C.jsxs)("div",{className:"bg-white/5 rounded-3xl p-5 border border-white/5 flex items-center gap-4",children:[(0,C.jsx)("div",{className:"size-10 rounded-2xl bg-[#00d4ff]/10 flex items-center justify-center text-[#00d4ff] shrink-0",children:(0,C.jsx)(T.Wrench,{size:20})}),(0,C.jsxs)("div",{children:[(0,C.jsx)("p",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest mb-0.5",children:"Hardware"}),(0,C.jsxs)("p",{className:"text-sm font-black text-white uppercase tracking-tight",children:[s.equipment?.brand," ",s.equipment?.type]})]})]})]})]}),(0,C.jsxs)("div",{className:"space-y-4 pt-6 pb-10",children:[(0,C.jsxs)(Z.motion.button,{whileTap:{scale:.98},onClick:ec,className:"w-full py-5 bg-[#135bec] hover:bg-blue-600 rounded-[1.8rem] text-white font-black flex items-center justify-center gap-4 shadow-[0_15px_40px_rgba(19,91,236,0.3)] transition-all group",children:[(0,C.jsx)("div",{className:"size-8 rounded-xl bg-white/10 flex items-center justify-center group-hover:rotate-12 transition-transform",children:(0,C.jsx)(K,{size:20})}),(0,C.jsx)("span",{className:"uppercase tracking-[0.2em] text-sm",children:"Validar y Confirmar"})]}),(0,C.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,C.jsxs)(Z.motion.button,{whileTap:{scale:.95},onClick:()=>window.open(`tel:${s.client?.phone}`,"_self"),className:"py-4 bg-gray-900 hover:bg-gray-800 border border-white/5 rounded-[1.5rem] flex items-center justify-center gap-3 text-gray-400 font-black transition-all",children:[(0,C.jsx)(B.Phone,{size:18}),(0,C.jsx)("span",{className:"text-[10px] uppercase tracking-widest",children:"Llamar"})]}),(0,C.jsxs)(Z.motion.button,{whileTap:{scale:.95},onClick:()=>e.push("/ai-assistant"),className:"py-4 bg-gray-900 hover:bg-gray-800 border border-white/5 rounded-[1.5rem] flex items-center justify-center gap-3 text-[#00ff9d] font-black transition-all",children:[(0,C.jsx)(D.Bot,{size:18}),(0,C.jsx)("span",{className:"text-[10px] uppercase tracking-widest",children:"Asistente"})]})]}),(0,C.jsx)("button",{onClick:el,className:"w-full py-2 text-[10px] font-bold text-gray-600 hover:text-white uppercase tracking-[0.4em] transition-colors",children:"Omitir Confirmaci√≥n e Iniciar"})]})]})]},"pre-visit"):(0,C.jsxs)(Z.motion.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"flex-1 overflow-y-auto",children:[(0,C.jsxs)("div",{className:"px-6 py-4 bg-[#135bec]/10 border-b border-[#135bec]/20 flex items-center justify-center gap-3 shadow-inner",children:[(0,C.jsx)("div",{className:"size-2 rounded-full bg-[#00ff9d] shadow-[0_0_10px_#00ff9d]"}),(0,C.jsx)("span",{className:"text-[10px] font-black text-[#135bec] uppercase tracking-[0.3em]",children:"Servicio en Ejecuci√≥n"})]}),(0,C.jsxs)("div",{className:"flex-1 flex flex-col w-full space-y-10 py-10 overflow-y-auto pb-44",children:[s&&(0,C.jsx)("section",{className:"px-6",children:(0,C.jsxs)("div",{className:"bg-gray-900/60 border border-white/10 rounded-[2.5rem] p-6 flex items-center gap-6 shadow-2xl relative overflow-hidden group",children:[(0,C.jsx)("div",{className:"absolute right-0 top-0 bottom-0 w-1 bg-[#135bec]/30"}),(0,C.jsx)("div",{className:"size-16 rounded-[1.5rem] bg-[#135bec]/10 border border-[#135bec]/20 flex items-center justify-center text-[#135bec] shadow-inner",children:(0,C.jsx)(T.Wrench,{size:32})}),(0,C.jsxs)("div",{children:[(0,C.jsxs)("div",{className:"flex items-center gap-3",children:[(0,C.jsxs)("h3",{className:"font-black text-xl leading-tight text-white",children:[s.equipment?.brand," ",s.equipment?.type]}),s.is_warranty&&(0,C.jsx)("span",{className:"bg-amber-500/10 text-amber-500 text-[8px] px-2 py-0.5 rounded-full font-black uppercase border border-amber-500/20",children:"Garant√≠a"})]}),(0,C.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,C.jsx)(W.User,{size:10,className:"text-[#135bec]"}),(0,C.jsx)("p",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-widest",children:s.client?.full_name})]})]})]})}),(0,C.jsxs)("section",{className:"px-6 space-y-4",children:[(0,C.jsxs)("label",{className:"flex items-center gap-3 text-[10px] font-black text-gray-500 uppercase tracking-[0.3em] px-1",children:[(0,C.jsx)(R,{className:"text-[#135bec]",size:18}),(0,C.jsx)("span",{children:"Informe T√©cnico Profesional"})]}),(0,C.jsxs)("div",{className:"relative group",children:[(0,C.jsx)("textarea",{className:"w-full rounded-[2.5rem] border border-white/5 bg-gray-900/30 focus:border-[#135bec] focus:bg-gray-900/50 text-base min-h-[180px] p-6 text-white placeholder:text-gray-700 resize-none transition-all shadow-inner outline-none leading-relaxed",placeholder:"Describa el hallazgo t√©cnico, pruebas realizadas y resoluci√≥n...",value:a,onChange:e=>i(e.target.value)}),(0,C.jsx)(Z.motion.button,{whileTap:{scale:.9},className:"absolute bottom-5 right-5 p-4 bg-gray-900/80 backdrop-blur-md text-[#135bec] hover:text-white hover:bg-[#135bec] rounded-2xl transition-all shadow-xl border border-white/5",children:(0,C.jsx)(A.Mic,{size:24})})]})]}),(0,C.jsxs)("section",{className:"px-6 space-y-4",children:[(0,C.jsxs)("label",{className:"flex items-center gap-3 text-[10px] font-black text-gray-500 uppercase tracking-[0.3em] px-1",children:[(0,C.jsx)(q.Wallet,{className:"text-[#00ff9d]",size:18}),"Liquidaci√≥n de Mano de Obra"]}),(0,C.jsxs)("div",{className:"relative group",children:[(0,C.jsx)("span",{className:"absolute left-6 top-1/2 -translate-y-1/2 text-gray-600 font-black text-xl",children:"$"}),(0,C.jsx)("input",{type:"number",value:_,onChange:e=>N(e.target.value),className:"w-full bg-gray-900/30 rounded-[1.8rem] py-6 pl-12 pr-6 text-2xl font-black border border-white/5 focus:border-[#00ff9d] focus:bg-gray-900/50 outline-none transition-all placeholder:text-gray-800",placeholder:"0"})]})]}),(0,C.jsxs)("section",{className:"px-6 space-y-4",children:[(0,C.jsxs)("label",{className:"flex items-center gap-3 text-[10px] font-black text-gray-500 uppercase tracking-[0.3em] px-1",children:[(0,C.jsx)(D.Bot,{className:"text-[#00ff9d]",size:18}),"Recomendaciones IA para Cliente"]}),(0,C.jsxs)("div",{className:"bg-gray-900/40 border border-white/5 rounded-[2.5rem] p-6 space-y-5 shadow-inner",children:[(0,C.jsx)("div",{className:"relative min-h-[100px] bg-black/20 rounded-2xl border border-white/5 p-4",children:v?(0,C.jsxs)("div",{className:"flex flex-col items-center justify-center h-20 gap-3",children:[(0,C.jsx)("div",{className:"size-5 border-2 border-[#00ff9d]/30 border-t-[#00ff9d] rounded-full animate-spin"}),(0,C.jsx)("p",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest animate-pulse",children:"ServiBot IA est√° redactando..."})]}):(0,C.jsx)("textarea",{className:"w-full h-full bg-transparent text-sm text-gray-300 placeholder:text-gray-700 resize-none outline-none leading-relaxed font-medium no-scrollbar",placeholder:"Genera sugerencias personalizadas de mantenimiento post-reparaci√≥n...",value:r,onChange:e=>o(e.target.value)})}),(0,C.jsxs)(Z.motion.button,{whileTap:{scale:.95},onClick:ed,disabled:v,className:"w-full bg-gradient-to-r from-[#135bec] to-indigo-600 py-4 rounded-2xl flex items-center justify-center gap-3 shadow-lg shadow-[#135bec]/20 disabled:opacity-50",children:[(0,C.jsx)(Q.Sparkles,{size:18,className:"text-[#00ff9d]"}),(0,C.jsx)("span",{className:"text-[10px] font-black text-white uppercase tracking-[0.2em]",children:"Sugerir Cuidado del Equipo"})]})]})]}),(0,C.jsxs)("section",{className:"px-6 space-y-6",children:[(0,C.jsxs)("label",{className:"flex items-center gap-3 text-[10px] font-black text-gray-500 uppercase tracking-[0.3em] px-1",children:[(0,C.jsx)(P.Box,{className:"text-[#135bec]",size:18}),"Componentes Remplazados"]}),(0,C.jsxs)("div",{className:"space-y-4",children:[(0,C.jsx)(ee.AnimatePresence,{children:j.map(e=>(0,C.jsxs)(Z.motion.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"flex items-center justify-between p-5 bg-gray-900/40 rounded-[2rem] border border-white/5 shadow-inner",children:[(0,C.jsxs)("div",{className:"flex items-center gap-4",children:[(0,C.jsx)("div",{className:"size-12 rounded-2xl bg-gray-900 border border-white/10 flex items-center justify-center text-gray-500",children:(0,C.jsx)(P.Box,{size:24})}),(0,C.jsxs)("div",{children:[(0,C.jsx)("h4",{className:"text-sm font-black text-white",children:e.name}),(0,C.jsxs)("p",{className:"text-[10px] text-gray-600 font-bold uppercase tracking-widest mt-0.5",children:[e.quantity," UND ‚Ä¢ $",e.unit_price?.toLocaleString()," C/U"]})]})]}),(0,C.jsxs)("div",{className:"flex items-center gap-4",children:[(0,C.jsxs)("p",{className:"text-sm font-black text-[#00ff9d]",children:["$",(e.unit_price*e.quantity).toLocaleString()]}),(0,C.jsx)("button",{onClick:()=>{var t;return t=e.id,void I(j.filter(e=>e.id!==t))},className:"size-10 flex items-center justify-center rounded-xl bg-rose-500/10 text-rose-500 hover:bg-rose-500 hover:text-white transition-all",children:(0,C.jsx)(F.XCircle,{size:18})})]})]},e.id))}),(0,C.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,C.jsxs)(Z.motion.button,{whileTap:{scale:.98},onClick:()=>ea(!0),className:"flex items-center justify-center gap-4 rounded-[2rem] border-2 border-dashed border-gray-800 py-6 text-gray-500 hover:border-[#135bec] hover:text-[#135bec] transition-all group bg-gray-900/10",children:[(0,C.jsx)(M.PlusCircle,{className:"group-hover:rotate-90 transition-transform",size:24}),(0,C.jsx)("span",{className:"font-black text-[10px] uppercase tracking-[0.3em]",children:"Stock"})]}),(0,C.jsxs)(Z.motion.button,{whileTap:{scale:.98},onClick:()=>e.push(`/scanner?context=service_order&id=${t}`),className:"flex items-center justify-center gap-4 rounded-[2rem] border-2 border-dashed border-rose-500/20 py-6 text-gray-500 hover:border-rose-500 hover:text-rose-500 transition-all group bg-rose-500/[0.02]",children:[(0,C.jsx)(X.QrCode,{className:"group-hover:scale-110 transition-transform text-rose-500",size:24}),(0,C.jsx)("span",{className:"font-black text-[10px] uppercase tracking-[0.3em]",children:"IA Scan"})]})]})]})]}),(0,C.jsxs)("section",{className:"px-6 space-y-4",children:[(0,C.jsxs)("label",{className:"flex items-center gap-3 text-[10px] font-black text-gray-500 uppercase tracking-[0.3em] px-1",children:[(0,C.jsx)(J,{className:"text-[#135bec]",size:18}),"Facturaci√≥n y Cobro"]}),(0,C.jsxs)("div",{className:"bg-gray-900/40 border border-dashed border-white/10 rounded-[2.5rem] p-6 flex items-center justify-between group hover:border-[#135bec]/40 transition-all cursor-pointer shadow-inner",children:[(0,C.jsxs)("div",{className:"flex items-center gap-4",children:[(0,C.jsx)("div",{className:"size-12 rounded-2xl bg-gray-800/80 flex items-center justify-center text-gray-500 group-hover:text-[#135bec] transition-colors shadow-lg",children:(0,C.jsx)(P.Box,{size:20})}),(0,C.jsxs)("div",{children:[(0,C.jsx)("p",{className:"text-sm font-black text-white",children:"Factura de Servicio"}),(0,C.jsx)("p",{className:"text-[9px] text-gray-600 font-black uppercase tracking-widest mt-0.5",children:"Pendiente de Generaci√≥n"})]})]}),(0,C.jsx)(Z.motion.button,{whileTap:{scale:.9},onClick:()=>e.push(`/invoice-preview/${t}`),className:"h-10 px-5 rounded-xl bg-gray-900 border border-white/5 text-[#00ff9d] text-[10px] font-black uppercase tracking-widest hover:bg-[#00ff9d] hover:text-black transition-all shadow-xl",children:"Pre-visualizar"})]})]}),(0,C.jsxs)("section",{className:"px-6 pb-20 space-y-6",children:[(0,C.jsxs)("label",{className:"flex items-center gap-3 text-[10px] font-black text-gray-500 uppercase tracking-[0.3em] px-1",children:[(0,C.jsx)(V,{className:"text-[#135bec]",size:18}),"Conformidad y Firma Digital"]}),(0,C.jsx)("div",{className:"bg-gray-900/40 border border-white/5 rounded-[3rem] p-2 shadow-inner overflow-hidden",children:(0,C.jsx)(eV,{onSave:e=>c(e),onClear:()=>c(null)})})]})]}),(0,C.jsx)("div",{className:"fixed bottom-0 left-0 right-0 max-w-md mx-auto z-[70] bg-[#0a0c10]/80 backdrop-blur-2xl border-t border-white/5 p-8 animate-in slide-in-from-bottom duration-500 pt-6",children:(0,C.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,C.jsxs)("div",{className:"flex justify-between items-end px-2",children:[(0,C.jsxs)("div",{className:"space-y-1",children:[(0,C.jsx)("span",{className:"text-[9px] font-black text-gray-500 uppercase tracking-widest block",children:"Liquidaci√≥n Estimada"}),(0,C.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,C.jsx)("span",{className:"text-sm text-[#135bec] font-black",children:"TOTAL"}),(0,C.jsxs)("span",{className:"text-2xl font-black text-white tracking-tighter",children:["$",(Number(_||0)+j.reduce((e,t)=>e+t.unit_price*t.quantity,0)).toLocaleString()]})]})]}),(0,C.jsxs)("div",{className:"text-right",children:[(0,C.jsx)("span",{className:"text-[9px] font-black text-[#00ff9d] uppercase tracking-widest block mb-1",children:"Stock Aplicado"}),(0,C.jsxs)("p",{className:"text-xs font-bold text-gray-400",children:["$",j.reduce((e,t)=>e+t.unit_price*t.quantity,0).toLocaleString()]})]})]}),(0,C.jsx)(Z.motion.button,{whileTap:{scale:.95},onClick:eu,disabled:b,className:"w-full bg-[#135bec] text-white font-black py-5 px-8 rounded-[2rem] shadow-[0_20px_40px_rgba(19,91,236,0.3)] transition-all flex items-center justify-center gap-4 relative overflow-hidden group",children:b?(0,C.jsx)("div",{className:"size-6 border-4 border-white/30 border-t-white rounded-full animate-spin"}):(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("span",{className:"text-sm uppercase tracking-[0.3em]",children:"Cerrar y Facturar"}),(0,C.jsx)(J,{size:20}),(0,C.jsx)(Z.motion.div,{className:"absolute inset-0 bg-white/10 -translate-x-full group-hover:translate-x-full transition-transform duration-700 skew-x-12"})]})})]})})]},"execution")}),(0,C.jsx)(ee.AnimatePresence,{children:d&&(0,C.jsx)("div",{className:"fixed inset-0 z-[200] flex items-center justify-center bg-black/95 backdrop-blur-2xl p-6",children:(0,C.jsxs)(Z.motion.div,{initial:{scale:.9,opacity:0,y:30},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:30},className:"bg-[#0f1115] w-full max-w-sm rounded-[3.5rem] border border-white/10 shadow-[0_50px_100px_rgba(0,0,0,0.8)] overflow-hidden",children:[(0,C.jsxs)("div",{className:"p-8 border-b border-white/5 bg-[#135bec]/5 flex justify-between items-center",children:[(0,C.jsxs)("div",{className:"flex items-center gap-4",children:[(0,C.jsx)("div",{className:"size-14 rounded-2xl bg-[#00ff9d]/10 flex items-center justify-center text-[#00ff9d] shadow-inner",children:(0,C.jsx)(H.MessageCircle,{size:28})}),(0,C.jsxs)("div",{children:[(0,C.jsx)("h3",{className:"font-black text-lg text-white leading-tight",children:"ServiBot IA"}),(0,C.jsx)("p",{className:"text-[9px] text-gray-500 font-black uppercase tracking-widest mt-0.5",children:"WhatsApp Predictivo"})]})]}),(0,C.jsx)("button",{onClick:()=>u(!1),className:"size-10 flex items-center justify-center rounded-2xl bg-gray-900 border border-white/5 text-gray-600 hover:text-white",children:(0,C.jsx)(F.XCircle,{size:20})})]}),(0,C.jsxs)("div",{className:"p-8 space-y-8",children:[(0,C.jsxs)("div",{className:"relative group",children:[(0,C.jsxs)("div",{className:`bg-[#0b141a] rounded-[2rem] rounded-tl-none border border-white/10 p-6 shadow-2xl transition-all ${f?"blur-[4px] opacity-40":""}`,children:[(0,C.jsx)("textarea",{value:h,onChange:e=>p(e.target.value),className:"w-full h-40 bg-transparent text-gray-200 text-sm leading-relaxed resize-none outline-none no-scrollbar font-bold",placeholder:"Redactando mensaje..."}),(0,C.jsxs)("div",{className:"flex justify-end items-center gap-2 mt-4",children:[(0,C.jsx)(Q.Sparkles,{size:12,className:"text-[#135bec]"}),(0,C.jsx)("span",{className:"text-[10px] text-gray-600 font-black uppercase tracking-widest",children:"IA Engine Optimized"})]})]}),(0,C.jsx)("div",{className:"absolute -top-[1px] -left-3 w-4 h-4 bg-[#0b141a] border-l border-t border-white/10",style:{clipPath:"polygon(100% 0, 0 0, 100% 100%)"}})]}),(0,C.jsxs)("div",{className:"space-y-4",children:[(0,C.jsxs)(Z.motion.button,{whileTap:{scale:.95},onClick:()=>{let e=encodeURIComponent(h),t=s.client?.phone?.replace(/\D/g,"");window.open(`https://wa.me/${t}?text=${e}`,"_blank"),el(),u(!1)},disabled:f||!h,className:"w-full h-16 bg-[#00ff9d] hover:bg-[#00e08b] text-black font-black rounded-2xl shadow-[0_15px_30px_rgba(0,255,157,0.2)] flex items-center justify-center gap-4 transition-all disabled:opacity-50",children:[(0,C.jsx)(L.Check,{size:24}),(0,C.jsx)("span",{className:"text-sm uppercase tracking-widest",children:"Enviar y Activar"})]}),(0,C.jsx)("button",{onClick:()=>u(!1),className:"w-full py-2 text-gray-500 hover:text-white font-black text-[9px] uppercase tracking-[0.4em] transition-colors",children:"Corregir Manualmente"})]})]}),f&&(0,C.jsx)("div",{className:"h-1.5 w-full bg-gray-900 absolute bottom-0",children:(0,C.jsx)(Z.motion.div,{animate:{x:["-100%","100%"]},transition:{duration:1.5,repeat:1/0,ease:"easeInOut"},className:"h-full w-1/2 bg-[#135bec] shadow-[0_0_15px_#135bec]"})})]})})}),(0,C.jsx)(ee.AnimatePresence,{children:en&&(0,C.jsx)(Z.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[150] bg-black/90 backdrop-blur-xl flex items-end justify-center p-6",children:(0,C.jsxs)(Z.motion.div,{initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:200},className:"w-full max-w-md bg-[#0d0f14] border-t border-white/10 rounded-t-[4rem] p-10 max-h-[85vh] flex flex-col shadow-[0_-50px_100px_rgba(0,0,0,0.5)]",children:[(0,C.jsx)("div",{className:"absolute top-5 left-1/2 -translate-x-1/2 w-14 h-1.5 bg-gray-800 rounded-full"}),(0,C.jsxs)("div",{className:"flex items-center justify-between mb-10",children:[(0,C.jsxs)("div",{children:[(0,C.jsx)("h3",{className:"text-2xl font-black text-white tracking-tight",children:"Seleccionar Repuestos"}),(0,C.jsx)("p",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-widest mt-1",children:"Inventario Central Pro"})]}),(0,C.jsx)(Z.motion.button,{whileTap:{scale:.9},onClick:()=>ea(!1),className:"size-12 flex items-center justify-center rounded-2xl bg-gray-900 border border-white/10 text-gray-500",children:(0,C.jsx)(F.XCircle,{size:24})})]}),(0,C.jsxs)("div",{className:"relative mb-10 group",children:[(0,C.jsx)(z.Search,{className:"absolute left-6 top-1/2 -translate-y-1/2 text-gray-600 group-focus-within:text-[#135bec] transition-colors",size:20}),(0,C.jsx)("input",{type:"text",placeholder:"Nombre o c√≥digo de pieza...",className:"w-full bg-gray-900/50 border border-white/5 rounded-[1.8rem] py-6 pl-14 pr-6 text-sm focus:border-[#135bec] focus:bg-gray-900 outline-none transition-all placeholder:text-gray-700",value:ei,onChange:e=>er(e.target.value)})]}),(0,C.jsx)("div",{className:"flex-1 overflow-y-auto space-y-4 no-scrollbar pb-10",children:et.filter(e=>e.name.toLowerCase().includes(ei.toLowerCase())).map((e,t)=>(0,C.jsxs)(Z.motion.button,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.05*t},onClick:()=>eh(e),className:"w-full flex items-center justify-between p-6 bg-gray-900/30 border border-white/5 rounded-[2.5rem] hover:bg-gray-900 hover:border-white/10 transition-all text-left group overflow-hidden relative",children:[(0,C.jsx)("div",{className:"absolute left-0 top-0 bottom-0 w-1 bg-[#135bec] opacity-0 group-hover:opacity-100 transition-opacity"}),(0,C.jsxs)("div",{className:"flex items-center gap-5",children:[(0,C.jsx)("div",{className:"size-14 rounded-[1.3rem] bg-gray-900 border border-white/5 flex items-center justify-center text-[#135bec] font-black text-base shadow-inner",children:e.code.substring(0,2)}),(0,C.jsxs)("div",{children:[(0,C.jsx)("p",{className:"text-base font-black text-white",children:e.name}),(0,C.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,C.jsxs)("span",{className:"text-[10px] text-[#00ff9d] font-black uppercase tracking-widest",children:["STOCK ",e.stock_level]}),(0,C.jsx)("div",{className:"size-1 rounded-full bg-gray-700"}),(0,C.jsx)("span",{className:"text-[10px] text-gray-600 font-bold uppercase",children:e.code})]})]})]}),(0,C.jsxs)("div",{className:"text-right",children:[(0,C.jsxs)("p",{className:"text-lg font-black text-white tracking-tight",children:["$",e.unit_price.toLocaleString()]}),(0,C.jsx)("div",{className:"size-8 rounded-full bg-gray-900 border border-white/5 flex items-center justify-center text-[#135bec] ml-auto mt-2 pointer-events-none",children:(0,C.jsx)(M.PlusCircle,{size:18})})]})]},e.id))})]})})})]})}e.s(["default",()=>eX],89725)}]);